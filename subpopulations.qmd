# Subpopulations
{{< include macros.qmd >}}
{{< include macros_statistics.qmd >}}


## Subpopulations {#sec-subpopulations}

When we have a statistical population with a joint variate, it is often of interest to focus on a subset of units that share the same value of a particular variate.

Consider for instance the following population, a modified version of the glass-forensics example:

- *units:* glass fragments (collected at specific locations)
- *variate:* the joint variate $(\vCa, \vSi, \vType)$ consisting of three simple variates:
	+ weight fraction of **Ca**lcium in the fragment (ordinal variate), with three possible values `low`, `medium`, `high`
	+ weight fraction of **Si**licon in the fragment (ordinal variate), with three possible values `low`, `medium`, `high`
    + **Type** of glass fragment (nominal variate), with seven possible values `building_windows_float_processed`, `building_windows_non_float_processed`, `containers`, `tableware`, `headlamps`


| [unit]{.yellow}  |        Ca  |        Si  |                                    Type  |
|:----------------:|:----------:|:----------:|:----------------------------------------:|
|    [1]{.yellow}  |     `low`  |    `high`  |                             `headlamps`  |
|    [2]{.yellow}  |     `low`  |  `medium`  |  `building_windows_non_float_processed`  |
|    [3]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|    [4]{.yellow}  |  `medium`  |  `medium`  |      `building_windows_float_processed`  |
|    [5]{.yellow}  |     `low`  |  `medium`  |                             `headlamps`  |
|    [6]{.yellow}  |  `medium`  |  `medium`  |                            `containers`  |
|    [7]{.yellow}  |     `low`  |  `medium`  |  `building_windows_non_float_processed`  |
|    [8]{.yellow}  |     `low`  |    `high`  |                             `tableware`  |
|    [9]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|   [10]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
: Glass fragments simplified {#tbl-glass-simple .sm}


Let's say we are interested only on those units that have the **Type** variate equal to `tableware`. Discarding all others we obtain a new, smaller population with four units:

| [unit]{.yellow}  |        Ca  |        Si  |                                    $\boldsymbol{\|}$Type  |
|:----------------:|:----------:|:----------:|:----------------------------------------:|
|    [3]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|    [8]{.yellow}  |     `low`  |    `high`  |                             `tableware`  |
|    [9]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|   [10]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
: Selection according to **Type** {#tbl-glass-tableware .sm}

were a bar "$\boldsymbol{\|}$" indicates the variate used for the selection.


As another example, we could be interested instead in those units that have both **Ca** *and* **Si** variates equal to `medium`. We obtain a smaller population with five units:

| [unit]{.yellow}  |        $\boldsymbol{\|}$Ca  |        $\boldsymbol{\|}$Si  |                                    Type  |
|:----------------:|:----------:|:----------:|:----------------------------------------:|
|    [3]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|    [4]{.yellow}  |  `medium`  |  `medium`  |      `building_windows_float_processed`  |
|    [6]{.yellow}  |  `medium`  |  `medium`  |                            `containers`  |
|    [9]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
|   [10]{.yellow}  |  `medium`  |  `medium`  |                             `tableware`  |
: {.sm}



Populations formed in this way are called [**subpopulations**]{.blue} of the original one. They are statistical populations in their own right. The notion of "subpopulation" is a relative notion. Any population can often be considered as a subpopulation of some larger population having additional variates.

:::{.callout-caution}
## {{< fa user-edit >}} Exercise
- From the population of [table @tbl-glass-simple]:
    + Construct he *marginal* population with variate **Ca**
    + Report the frequency distribution for the marginal population above (remember that **Ca** has *three* possible values)
    + Construct the subpopulation with variate **Si** equal to `high`
    + Construct the subpopulation with variate **Type** equal to `headlamps` and the variate **Si** equal to `medium`


*Check your understanding of the reasoning behind the notions of marginal population and subpopulation with this exercise:*

- From the population of [table @tbl-glass-simple], construct the subpopulation with variate **Type** equal to either `headlamps` *or* `tableware`.
:::


## Associations

The analysis of subpopulations is important because it often reveals peculiar [*associations*]{.blue} among different variates. Let's illustrate what we mean with "association" -- a term that we'll use loosely, not with a strict technical definition -- with an example.

If we extract the subpopulation having variate **Type** equal to `headlamps` from the population of [table @tbl-glass-simple]:

| [unit]{.yellow}  |        Ca  |        Si  |                                    $\boldsymbol{\|}$Type  |
|:----------------:|:----------:|:----------:|:----------------------------------------:|
|    [1]{.yellow}  |     `low`  |    `high`  |                             `headlamps`  |
|    [5]{.yellow}  |     `low`  |  `medium`  |                             `headlamps`  |
: {.sm}

we notice that all units have variate **Ca** equal to `low`. It is therefore impossible to observe other values of **Ca** in this new population.^[We are not claiming that this fact will be true if new units are considered; this important question will be discussed later.]

On the other hand, if we extract the subpopulation having variate **Ca** equal to `low` we obtain

| [unit]{.yellow}  |        $\boldsymbol{\|}$Ca  |        Si  |                                    Type  |
|:----------------:|:----------:|:----------:|:----------------------------------------:|
|    [1]{.yellow}  |     `low`  |    `high`  |                             `headlamps`  |
|    [2]{.yellow}  |     `low`  |  `medium`  |  `building_windows_non_float_processed`  |
|    [5]{.yellow}  |     `low`  |  `medium`  |                             `headlamps`  |
|    [7]{.yellow}  |     `low`  |  `medium`  |  `building_windows_non_float_processed`  |
|    [8]{.yellow}  |     `low`  |    `high`  |                             `tableware`  |
: {.sm}

so the reverse is *not* true: if **Ca** is equal to `low`, that does *not* mean that it's impossible to observe other **Type** values besides `headlamps`. In the original population we have, figuratively speaking, the following interesting association:

$$
\vType\mo \cat{headlamps}\ \mathrel{\green\Rightarrow}\ 
\vCa\mo \cat{low}
\qquad\text{\small but}\qquad
\vCa\mo \cat{low}\  \mathrel{\red\nRightarrow}\ 
\vType\mo \cat{headlamps}
$$

This kind of associations is often useful. Suppose for instance that you are asked to pick a unit with **Ca** equal to `low` in the original population; but it's difficult to measure a unit's **Ca** value, while it's easy to measure its **Type** value. Then you could instead search for a unit having **Type** equal to `headlamps` (easier search), and you would be sure that the unit you found also has **Ca** equal to `low`.

\

The example above above, where some values of a variate completely exclude some values of another, is extreme. More often, a population can have less extreme but still useful associations. They are best quantified using conditional frequencies.


## Conditional frequencies {#sub-conditional-freqs}

Given a statistical population with joint variates ${\green X}, {\red Y}$ (and possibly others), we define the [**conditional frequency**]{.blue} of the value ${\red y}$ of  ${\red Y}$, given or "conditional on" the value ${\green x}$ of  ${\green X}$, as the frequency of the value ${\red y}$ in the subpopulation selected by ${\green X\mo x}$. This frequency is usually written

$$
f({\red Y\mo y} \| {\green X\mo x})
$$

where $f$ is the symbol for the joint frequency of the population.

Consider for instance the glass-fragment population of [table @tbl-glass-simple]. The conditional frequency of ${\red\vCa\mo \cat{low}}$ given ${\green\vType\mo \cat{tableware}}$ is the frequency of $\vCa\mo \cat{low}$ in the subpopulation of [table @tbl-glass-tableware], from which we find

$$
f({\red \vCa\mo \cat{low}} \| {\green \vType\mo \cat{tableware}}) = \frac{1}{4}
$$

The collection of these conditional frequencies for all values of ${\red Y}$ constitutes the [conditional-frequency distribution]{.blue} of ${\red Y}$ conditional on ${\green X\mo x}$. In our example this distribution has three conditional frequencies:

$$\begin{aligned}
&f({\red \vCa\mo \cat{low}} \| {\green \vType\mo \cat{tableware}}) = \frac{1}{4}
\\
&f({\red \vCa\mo \cat{medium}} \| {\green \vType\mo \cat{tableware}}) = \frac{3}{4}
\\
&f({\red \vCa\mo \cat{high}} \| {\green \vType\mo \cat{tableware}}) = 0
\end{aligned}$$

which sum up to $1$ as they should.

:::{.callout-warning}
## {{< fa exclamation-circle >}} Conditional on a *value* of a variate

It doesn't make sense to speak of the conditional-frequency distribution of $Y$ "conditional [on $X$"]{.yellow}. Conditional frequencies and frequency distributions are always conditional on some value of a variate. If we consider all possible values of $Y$ *and* of $X$ we obtain a collection of frequencies that is *not* a distribution.
:::

A conditional frequencies can be calculated as the ratio of a joint and a marginal frequencies, in a way analogous to conditional probabilities ([§ @sec-conditional-probs]):

$$
f({\red Y\mo y} \| {\green X\mo x}) =
\frac{f({\red Y\mo y}, {\green X\mo x})}{f({\green X\mo x})} =
\frac{f({\red Y\mo y}, {\green X\mo x})}{
\sum_{\red y} f({\red Y\mo y}, {\green X\mo x})}
$$

