# Multivariate probability distributions
{{< include macros.qmd >}}

So far we have considered  probability distributions for quantities of a basic (nominal, ordinal, binary, interval) type. These distributions have a sort of one-dimensional character and can be represented by ordinary histograms, line plots, and scatter plots. We now consider probability distributions for multivariate quantities.

[*(Make sure you're familiar with [ยง @sec-data-types-multi] before you begin.)*]{.small style="color:#EE6677;"}

## Joint probability distributions

A multivariate quantity, as discussed in [ยง  @sec-data-multiv], is just a collection or set of quantities of basic types. Saying that a multivariate quantity has a particular value means that each basic component quantity has a particular value in its specific domain. This is expressed by an `and` of sentences.

Consider for instance the multivariate quantity $X$ consisting of the age $\color[RGB]{102,204,238}A$ and sex $\color[RGB]{34,136,51}S$ of a specific person. The fact that $X$ has a particular value is expressed by a composite sentence such as
$$
\pr{The person's age is 25 years and the sex is female}
$$
which we can compactly write with an `and`:
$$
({\color[RGB]{102,204,238}A\mo 25\,\mathrm{y}}) \land ({\color[RGB]{34,136,51}S\mo\mathrm{F}})
$$
All the possible composite sentences of this kind are *mutually exclusive* and *exhaustive*.

An agent's uncertainty about $X$'s true value is therefore represented by a probability distribution over all `and`-ed sentences of this kind, representing all possible joint values:
$$
\P\bigl[({\color[RGB]{102,204,238}A \mo 25\,\mathrm{y}}) \land ({\color[RGB]{34,136,51}S\mo\mathrm{F}}) \| \yI\bigr] \ , \qquad
\P\bigl[({\color[RGB]{102,204,238}A \mo 31\,\mathrm{y}}) \land ({\color[RGB]{34,136,51}S\mo\mathrm{M}}) \| \yI\bigr] \ , \qquad
\dotsc
$$
where $\yI$ is the agent's state of knowledge, and the probabilities sum up to one. We call this a [**multivariate**]{.blue} or [**joint probability distribution**]{.blue}. Usually these probabilities are written in much abbreviated form, and the $\land$ is represented by a comma; for instance
$$
\P({\color[RGB]{102,204,238}25}, {\color[RGB]{34,136,51}\mathrm{F}} \| \yI) \ , \quad
\P({\color[RGB]{102,204,238}31}, {\color[RGB]{34,136,51}\mathrm{M}} \| \yI) \ , \quad
\dotsc
$$

## Joint probability densities

@@ TODO


## Representation of joint probability distributions

There is a wide variety of ways of representing multivariate probability distributions, and new ways are invented (and rediscovered) all the time. In some cases, especially when the quantity has more than three component quantities, it can become impossible to graphically represent the probability distribution in a faithful way. Therefore one often tries to represent only some aspects or features of interest from the full distribution. Whenever you see a plot of a multivariate probability distribution, you should carefully read what the plot shows and how it was made. Here we only illustrate some examples and ideas for representations.

### Tables

When a quantity is *bi*variate and its two component quantities are both discrete and finite, the joint probabilities can be reported as a table.

Example: Consider the next patient that will arrive at a particular hospital. There's the possibility of arrival by `ambulance`, `helicopter`, or `other` transportation means; and the possibility that the patient will need `urgent` `non-urgent` care. These can be seen as two quantities $A$ (nominal) and $U$ (binary). When these two quantities are taken together; their joint probability distribution is as follows, conditional on the hospital's data $\yi[H]$:

+:---------------:+:---------------:+:---------------:+:---------------:+:---------------:+
|$\P(A,U\|\yi[H])$|                 |**arrival** $A$                                      |
+-----------------+-----------------+-----------------+-----------------+-----------------+
|                 |                 |ambulance        |helicopter       |other            |
+-----------------+-----------------+-----------------+-----------------+-----------------+
|**urgency** $U$  |urgent           |0.11             |0.04             |0.03             |
+                 +-----------------+-----------------+-----------------+-----------------+
|                 |non-urgent       |0.17             |0.01             |0.64             |
+-----------------+-----------------+-----------------+-----------------+-----------------+
: Joint probability distribution for transportation at arrival and urgency {#tbl-urgent-arrival}

We see for instance that the most probable possibility is that the next patient will arrive by transportation means other than ambulance and helicopter, and won't require urgent care.

It is also possible to replace the numerical probability values with graphical representations; for example as shades of a colour, or squares with different areas.

@@ TODO ref to marginals section

### Multi-line plots

Joint probability distributions over one discrete and one continuous quantity (or ordinal discrete with numerous values) can be represented as a collection of line plots: each line plot represent the probability density for the continuous quantity and a specific value of the discrete quantity.

Consider for instance the probability that the next patient who arrives at a particular hospital has a given age (continuous quantity) and may require urgent care or not (binary quantity). The joint probability density can be visualized as in the plot in the margin. From the plot we can see that the probability of urgent patients is generally lower than non-urgent ones. A possibly disadvantage of this kind of plots is evident: the details, such as peaks, of the density for some values of the discrete quantity may be barely visible.

::::{.column-margin}
![](hospital_age_urgent.png){width=100%}
::::


### Surface plots

### Scatter plots

@@ TODO work also for 3D


\

## Marginal probabilities

In some situations we have the joint probability distribution for a multivariate quantity, but we are interested in the probability for a particular value of one of the component quantities only, or in the probability distribution for that component -- irrespective of what the values for the other components might be.

Consider for instance the joint probability of [table @tbl-urgent-arrival]. We may be interested in the probability that the next patient will need urgent care, *independently of how the patient got to the hospital*. This probability can be found, as usual, by analysing the problem in terms of *sentences* and using the [basic rules of inference from ยง @sec-fundamental].

The sentence we want is
$$
\pr{The next patient will require urgent care}
$$
which is equivalent to
$$
\pr{The next patient will require urgent care, and will arrive by ambulance, helicopter, or in by other means}
$$
This last sentence can be written by means of `and` and `or` connectives:
$$
\begin{aligned}
&\pr{The next patient will require urgent care} \land{}
\\[1ex]
&\qquad\bigl(\pr{The next patient will arrive by ambulance} \lor {}
\\&\qquad\qquad
\pr{The next patient will arrive by helicopter} \lor {}
\\&\qquad\qquad
\pr{The next patient will arrive by other means}\bigr)
\end{aligned}
$$
which we can compactly write as
$$
\begin{aligned}
&\prq{urgent}\land
(\prq{ambulance} \lor \prq{helicopter} \lor \prq{other})
\\[1ex]
&\qquad{}=
(\prq{urgent}\land \prq{ambulance}) \lor
(\prq{urgent}\land \prq{helicopter}) \lor
(\prq{urgent}\land \prq{other})
\end{aligned}
$$
where the second, equivalent form comes from the [derived rules of Boolean algebra of ยง @sec-boolean].

The last sentence is an `or` of mutually exclusive sentences. Its probability is therefore given by the `or` rule:
$$
\begin{aligned}
&\P\bigl[
(\prq{urgent}\land \prq{ambulance}) \lor
(\prq{urgent}\land \prq{helicopter}) \lor
(\prq{urgent}\land \prq{other})
\| \yi[H] \bigr]
\\[1ex]
&\qquad{}=
\P(\prq{urgent}\land \prq{ambulance}\| \yi[H] ) +
\P(\prq{urgent}\land \prq{ambulance}\| \yi[H] ) +
\P(\prq{urgent}\land \prq{other}\| \yi[H] )
\end{aligned}
$$

The probability for a value of the urgency quantity, independently of the value of the arrival-means quantity, can be found by summing all joint probabilities with all possible arrival-means values. Using the $\sum$-notation we can write
$$
\P(\prq{urgent} \| \yi[H]) =
\sum_{\mathclap{A=\prq{ambulance}}}^{\mathclap{\prq{other}}}
\P(\prq{urgent}, A \| \yi[H])
$$

This is called a [**marginal probability**]{.blue}.

:::{.callout-caution}
## {{< fa user-edit >}} Exercise
Using the values from [table @tbl-urgent-arrival], calculate:

- the marginal probability that the next patient will need urgent care
- the marginal probability that the next patient will arrive by helicopter
:::

